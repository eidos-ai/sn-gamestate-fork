# TrackLab SoccerNet config

# The defaults list contains the files that will be used
# to create the final config file. This item *must* be
# the first element in the file.
defaults:
  - dataset: soccernet_gs
  - eval: trackeval
  - engine: offline
  - state: save
  - visualization: save_videos
  - modules/bbox_detector: yolov8
  - modules/pose_bottomup: openpifpaf
  - modules/reid: prtreid
  - modules/track: oc_sort
  - modules/jersey_number_detect: mmocr
  - modules/team: kmeans_embeddings
  - modules/team_side: mean_position
  - modules/tracklet_agg: voting_role_jn
  - modules/pitch : tvcalib
  - modules/calibration: tvcalib
  - _self_

# Pipeline definition :
# - Defines the order in which the modules will be called
# - If loading a tracking state from disk, remove modules whose outputs are already provided in the loaded state
pipeline:
  - bbox_detector
  - reid
  - track
  - pitch
  - calibration
  - jersey_number_detect
  - team
  - team_side
  - tracklet_agg


# Experiment name
experiment_name: "sn-gamestate"

# Path definitions
data_dir: "${project_dir}/data"
model_dir: "${project_dir}/pretrained_models"

# Machine configuration
num_cores: 4
use_wandb: False
use_rich: True

modules: # Allows module-specific batch_size and other configuration
  bbox_detector: {batch_size: 8}
  pose_bottomup: {batch_size: 8}
  reid: {batch_size: 64}
  track: {batch_size: 64}
  jersey_number_detect: {batch_size: 8}

# Flags
test_tracking: True
print_config: False

# configure Hydra to use the current working directory
# and set up the output directory according to experiment_name
project_dir: "${hydra:runtime.cwd}"
hydra:
  job:
    chdir: True
  run:
    dir: "outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}"
  sweep:
    dir: "multirun_outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}"
